# ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ - Llama3-8B - [LB 0.750+] - [ãƒ©ãƒ³ã‚¯ 59ä½]
**Chris Deotte** *2024å¹´7æœˆ16æ—¥ ç«æ›œæ—¥ 09:54:06 GMT+0900 (æ—¥æœ¬æ¨™æº–æ™‚)* (59ç¥¨)
ã“ã‚“ã«ã¡ã¯ã€çš†ã•ã‚“ï¼ç¾åœ¨ã®æå‡ºç‰©ã‚’å…±æœ‰ã—ã¾ã™ã€‚ç¾åœ¨ã€å…¬é–‹ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ã§0.750ä»¥ä¸Šã®ã‚¹ã‚³ã‚¢ã‚’é”æˆã—ã¦ãŠã‚Šã€å…¬é–‹ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ã®ãƒ©ãƒ³ã‚¯ã¯59ä½ã§ã™ï¼(ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®æ›´æ–°å‰ã¯ã€ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ãŒå…¬é–‹ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ã§1ä½ã‚’é”æˆã—ã¾ã—ãŸðŸ¥‡ ðŸ˜€)ã€‚ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã¯ã“ã¡ã‚‰ã§ã™ï¼š[ã“ã“ã‚’ã‚¯ãƒªãƒƒã‚¯](https://www.kaggle.com/code/cdeotte/starter-code-for-llama-8b-llm-lb-0-750)ã€‚æ¥½ã—ã‚“ã§ãã ã•ã„ï¼
## è‰¯ã„ç‚¹
ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«ã¯ã„ãã¤ã‹ã®å•é¡Œï¼ˆå›ºå®šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãªã©ï¼‰ãŒã‚ã‚Šã¾ã™ãŒã€å¤šãã®å½¹ç«‹ã¤ã‚³ãƒ¼ãƒ‰ã‚‚å«ã¾ã‚Œã¦ãŠã‚Šã€ä»¥ä¸‹ã®å†…å®¹ã‚’ç¤ºã—ã¦ã„ã¾ã™ï¼š
- æ¤œç´¢ã‚’çµžã‚Šè¾¼ã‚€ãŸã‚ã«è³ªå•ã‚’ã™ã‚‹æˆ¦ç•¥ï¼ˆè£ã§ä½¿ç”¨ã•ã‚Œã‚‹ç‰¹å¾´ã®CSVã‚’ç”¨ã„ãŸæ–¹æ³•ï¼‰ã€‚
- æå‡ºæ™‚ã«ä½¿ç”¨ã™ã‚‹pipãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ–¹æ³•
- Hugging Faceã‹ã‚‰ä»»æ„ã®LLMãƒ¢ãƒ‡ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä½¿ç”¨ã™ã‚‹æ–¹æ³•
- LLMã®å›žç­”èƒ½åŠ›ã«å¯¾ã™ã‚‹EDAã®å®Ÿæ–½æ–¹æ³•
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã€æå‡ºã®ãŸã‚ã®tarballã‚’ä½œæˆã™ã‚‹æ–¹æ³•
- Kaggleã®APIã‚’å®Ÿè¡Œã—ã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ç›£è¦–ã™ã‚‹æ–¹æ³•
## æ‚ªã„ç‚¹
ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ã„ãã¤ã‹ã®å•é¡Œã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š
- å¤ã„ãƒªã‚¹ãƒˆã®å›ºå®šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆLBä¸­ã«å¤‰æ›´ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ï¼ˆå…¬é–‹LBã§ã¯æ—¢ã«å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ï¼‰ã€‚
- è³ªå•ãŒå ´æ‰€ã«é–¢ã™ã‚‹ã“ã¨ï¼ˆä¾‹ï¼š (1) ã©ã®ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªãƒ¼ã‹ï¼Ÿ (éƒ½å¸‚ã€å›½ã€ãƒ©ãƒ³ãƒ‰ãƒžãƒ¼ã‚¯)ã€(2) ã©ã®å¤§é™¸ã‹ï¼Ÿã€(3) æœ€åˆã®æ–‡å­—ã¯ä½•ã‹ï¼Ÿï¼‰ã®ã¿ã¨ãªã£ã¦ãŠã‚Šã€ç‰©ã«é–¢ã™ã‚‹è³ªå•ã¯ã—ã¦ã„ãªã„ã€‚
## æ”¹è‰¯æ–¹æ³•
ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆLBã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå¤‰ã‚ã£ãŸã¨ã—ã¦ã‚‚ã€ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨æˆ¦ç•¥ã‚’ä½¿ç”¨ã—ã¦ã€ã‚¦ã‚£ã‚­ãƒšãƒ‡ã‚£ã‚¢ã‹ã‚‰æ•°åƒã¾ãŸã¯æ•°ç™¾ä¸‡ã®å˜èªžã‚’é¸æŠžã—ã€ãã‚Œã‚’å…¨ã¦ã®æ½œåœ¨çš„ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆã¨ã—ã¦ä½¿ç”¨ã™ã‚‹æ–°ã—ã„ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½œæˆã§ãã¾ã™ã€‚
ãã®å¾Œã€ãã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«ã™ã¹ã¦ã®å˜èªžã‚’è¨˜è¿°ã™ã‚‹è¿½åŠ ã®ç‰¹å¾´ã‚’èª¬æ˜Žã™ã‚‹æ–°ã—ã„åˆ—ã‚’ä½œæˆã—ã€ã“ã‚Œã‚‰ã®è¿½åŠ ã®ç‰¹å¾´ã‚’æŒã¤ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‹ã©ã†ã‹ã‚’å°‹ã­ã‚‹äº‹å‰å®šç¾©ã•ã‚ŒãŸè³ªå•ã‚’ä½œæˆã—ã¾ã™ã€‚æœ€å¾Œã«ã€ä½œæˆã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ï¼ˆè¿½åŠ ã®åˆ—ç‰¹å¾´ã‚’æŒã¤ï¼‰ã¨ç‰¹å¾´ã«é–¢ã™ã‚‹å›žç­”è€…ã®åå¿œã«åŸºã¥ã„ã¦æŽ¨æ¸¬ã‚’è¡Œã„ã¾ã™ã€‚
# ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚³ãƒ¼ãƒ‰
ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚³ãƒ¼ãƒ‰ã¯[ã“ã¡ã‚‰](https://www.kaggle.com/code/cdeotte/starter-code-for-llama-8b-llm-lb-0-750)ã§ã™ã€‚
---
 # ãã®ä»–ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ã‚³ãƒ¡ãƒ³ãƒˆ
> ## mxmm2123
> 
> ç´ æ™´ã‚‰ã—ã„ä»•äº‹ã§ã™ã­ï¼
> 
> ---
> 
> ## Rishit Jakharia
> 
> ã“ã‚“ã«ã¡ã¯ï¼ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ã€‚
> 
> å®Ÿè£…ã«ãŠã„ã¦Llama 3ãƒ¢ãƒ‡ãƒ«ã®fp4é‡å­åŒ–ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã“ã¨ã«æ°—ã¥ãã¾ã—ãŸã€‚
> 
> GGUFé‡å­åŒ–ã‚’è©¦ã—ãŸã‹ã©ã†ã‹ã€ã‚‚ã—è©¦ã—ãŸãªã‚‰ç¾åœ¨ã®å®Ÿè£…ã¨æ¯”è¼ƒã—ãŸçµæžœã¯ã©ã†ã ã£ãŸã‹ã‚’çŸ¥ã‚ŠãŸã„ã§ã™ã€‚
> 
> > ## Chris Deotte (ãƒˆãƒ”ãƒƒã‚¯ä½œæˆè€…)
> > 
> > ã“ã‚“ã«ã¡ã¯ã€‚GGUFé‡å­åŒ–ã¯è©¦ã—ã¦ã„ã¾ã›ã‚“ã€‚ä»–ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆKaggleã®20ã®è³ªå•ã‚³ãƒ³ãƒšã§ã¯ãªã„ï¼‰ã§ã€Hugging Faceã®AutoModelForCausalLMã‚’ä½¿ç”¨ã—ã¦AWQé‡å­åŒ–ã‚’è©¦ã—ã¾ã—ãŸãŒã€fp4ã¨æ¯”ã¹ã¦éžå¸¸ã«é…ã‹ã£ãŸã§ã™ã€‚ã—ãŸãŒã£ã¦ã€GGUFã‚’è©•ä¾¡ã™ã‚‹éš›ã«ã¯ã€é€Ÿåº¦ã‚‚è€ƒæ…®ã«å…¥ã‚Œã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
> > 
> > > ## Rishit Jakharia
> > > 
> > > ãªã‚‹ã»ã©ã€ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ï¼
> > > > 
> > 
---
> ## Valentin Baltazar
> 
> åˆå¿ƒè€…ã®ç§ã«ã¨ã£ã¦éžå¸¸ã«å½¹ç«‹ã¤æƒ…å ±ã§ã™ï¼ã‚ã‚ŠãŒã¨ã†ã”ã–ã„ã¾ã™ã€‚
> 
> ---
> ## torino
> 
> [@cdeotte](https://www.kaggle.com/cdeotte) ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ã€‚ã‚ãªãŸãŒã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§Pythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã®ã‚’è¦‹ã¾ã—ãŸãŒã€ç§ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã§ã¯æå‡ºç’°å¢ƒç”¨ã«æ–°ã—ã„PyTorchã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã›ã‚“ï¼ˆæ™®é€šã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã§ã¯ã†ã¾ãã„ãã¾ã—ãŸï¼‰ã€‚ä½•ã‹ææ¡ˆãŒã‚ã‚Œã°æ•™ãˆã¦ãã ã•ã„ã€‚ç§ã®å•é¡Œã¯[ã“ã¡ã‚‰](https://www.kaggle.com/competitions/llm-20-questions/discussion/520207)ã§è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
> 
> ---
