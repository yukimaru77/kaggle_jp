# è¦ç´„ 
ã“ã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã¯ã€Kaggleã®ã€ŒLLM 20 Questionsã€ã‚³ãƒ³ãƒšãƒ†ã‚£ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹Llama3-8Bãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ãŸã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«ã¤ã„ã¦ã§ã™ã€‚æŠ•ç¨¿è€…ã¯Chris Deotteæ°ã§ã€ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯ãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ã§0.750+ã®ã‚¹ã‚³ã‚¢ã‚’ç²å¾—ã—ã€59ä½ã«ãƒ©ãƒ³ã‚¯ã‚¤ãƒ³ã—ã¦ã„ã¾ã™ã€‚

ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ä¸»ãªåˆ©ç‚¹ã¯ã€è³ªå•ã®æˆ¦ç•¥ã€LLMãƒ¢ãƒ‡ãƒ«ã®ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã¨ä½¿ç”¨ã€å›žç­”èƒ½åŠ›ã®EDAã€ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚³ãƒ¼ãƒ‰ã®ä½œæˆã€Kaggle APIã®å®Ÿè¡Œãªã©ã€ã‚³ãƒ³ãƒšãƒ†ã‚£ã‚·ãƒ§ãƒ³ã§å½¹ç«‹ã¤ã‚³ãƒ¼ãƒ‰ã‚’æä¾›ã—ã¦ã„ã‚‹ã“ã¨ã§ã™ã€‚

ã—ã‹ã—ã€ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«ã¯ã„ãã¤ã‹ã®æ¬ ç‚¹ã‚‚æŒ‡æ‘˜ã•ã‚Œã¦ã„ã¾ã™ã€‚ä¸€ã¤ã¯ã€å›ºå®šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ãŸã‚ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãƒªãƒ¼ãƒ€ãƒ¼ãƒœãƒ¼ãƒ‰ã§å¤‰æ›´ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚‹ã“ã¨ã§ã™ã€‚ã‚‚ã†ä¸€ã¤ã¯ã€å ´æ‰€ã«é–¢ã™ã‚‹è³ªå•ã—ã‹ã—ã¦ã„ãªã„ã“ã¨ã§ã™ã€‚

æŠ•ç¨¿è€…ã¯ã€ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’æ”¹å–„ã™ã‚‹ãŸã‚ã«ã€Wikipediaã‹ã‚‰æ•°åƒã¾ãŸã¯æ•°ç™¾ä¸‡ã®å˜èªžã‚’é¸æŠžã—ã€ãã®ãƒªã‚¹ãƒˆã‚’ã™ã¹ã¦ã®æ½œåœ¨çš„ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ã“ã¨ã‚’ææ¡ˆã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«æ–°ã—ã„åˆ—ã‚’ä½œæˆã—ã€ã™ã¹ã¦ã®å˜èªžã‚’è¨˜è¿°ã™ã‚‹è¿½åŠ ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã‚’ææ¡ˆã—ã¦ã„ã¾ã™ã€‚

ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã§ã¯ã€ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚‚å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚Rishit Jakhariaæ°ã¯ã€GGUFé‡å­åŒ–ã‚’è©¦ã—ãŸã‹ã©ã†ã‹ã‚’è³ªå•ã—ã¦ã„ã¾ã™ã€‚Chris Deotteæ°ã¯ã€GGUFé‡å­åŒ–ã¯è©¦ã—ã¦ã„ãªã„ãŒã€AWQé‡å­åŒ–ã¯fp4ã¨æ¯”ã¹ã¦éžå¸¸ã«é…ã‹ã£ãŸãŸã‚ã€GGUFã‚’è©•ä¾¡ã™ã‚‹éš›ã«ã¯é€Ÿåº¦ã‚‚è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã¨ç­”ãˆã¦ã„ã¾ã™ã€‚

torinoæ°ã¯ã€ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§Pythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã‚‹ãŒã€æå‡ºç’°å¢ƒã«æ–°ã—ã„pytorchã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ããªã„ã¨ã„ã†å•é¡Œã«ã¤ã„ã¦è³ªå•ã—ã¦ã„ã¾ã™ã€‚

ã“ã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã¯ã€ã‚³ãƒ³ãƒšãƒ†ã‚£ã‚·ãƒ§ãƒ³å‚åŠ è€…ã«ã¨ã£ã¦æœ‰ç›Šãªæƒ…å ±æºã§ã‚ã‚Šã€Llama3-8Bãƒ¢ãƒ‡ãƒ«ã‚’ä½¿ç”¨ã—ãŸã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ä½¿ç”¨æ–¹æ³•ã€æ”¹å–„æ–¹æ³•ã€ãŠã‚ˆã³ã‚³ãƒ³ãƒšãƒ†ã‚£ã‚·ãƒ§ãƒ³ã§ç™ºç”Ÿã™ã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹å•é¡Œã«ã¤ã„ã¦ç†è§£ã‚’æ·±ã‚ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚


---
# ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ - Llama3-8B - [LB 0.750+] - [ãƒ©ãƒ³ã‚¯ 59ä½]
**Chris Deotte** *2024å¹´7æœˆ16æ—¥ ç«æ›œæ—¥ 09:54:06 GMT+0900 (æ—¥æœ¬æ¨™æº–æ™‚)* (59ç¥¨)

çš†ã•ã‚“ã€ã“ã‚“ã«ã¡ã¯ï¼ç¾åœ¨ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯LBã§0.750+ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯LBãƒ©ãƒ³ã‚¯ã§59ä½ã‚’ç²å¾—ã—ã¦ã„ã‚‹ç§ã®ç¾åœ¨ã®æå‡ºç‰©ã‚’å…±æœ‰ã—ã¾ã™ï¼ï¼ˆã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®æ›´æ–°å‰ã¯ã€ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã¯ãƒ‘ãƒ–ãƒªãƒƒã‚¯LBã§1ä½ã‚’ç²å¾—ã—ã¦ã„ã¾ã—ãŸðŸ¥‡ðŸ˜€ï¼‰ã€‚ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã¯ã“ã¡ã‚‰ã§ã™ [https://www.kaggle.com/code/cdeotte/starter-code-for-llama-8b-llm-lb-0-750](https://www.kaggle.com/code/cdeotte/starter-code-for-llama-8b-llm-lb-0-750)ã€‚æ¥½ã—ã‚“ã§ãã ã•ã„ï¼

## è‰¯ã„ç‚¹
ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã«ã¯ã„ãã¤ã‹ã®å•é¡Œç‚¹ãŒã‚ã‚Šã¾ã™ãŒï¼ˆã¤ã¾ã‚Šã€ã„ãã¤ã‹ã®å›ºå®šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ï¼‰ã€å½¹ã«ç«‹ã¤ã‚³ãƒ¼ãƒ‰ã‚‚ãŸãã•ã‚“ã‚ã‚Šã¾ã™ã€‚ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã§ç¤ºã•ã‚Œã¦ã„ã‚‹å½¹ã«ç«‹ã¤ç‚¹ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚

- æ¤œç´¢ã‚’çµžã‚Šè¾¼ã‚€ãŸã‚ã®è³ªå•ã®ä»•æ–¹ã®æˆ¦ç•¥ï¼ˆãã—ã¦ã€è£å´ã§æ©Ÿèƒ½ã®CSVã‚’ä½¿ç”¨ã™ã‚‹ï¼‰ã€‚
- æå‡ºæ™‚ã«ä½¿ç”¨ã™ã‚‹pipãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹æ–¹æ³•ã€‚
- Hugging Faceã‹ã‚‰ä»»æ„ã®LLMãƒ¢ãƒ‡ãƒ«ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ã¦ä½¿ç”¨ã™ã‚‹æ–¹æ³•ã€‚
- LLMã®å›žç­”èƒ½åŠ›ã«é–¢ã™ã‚‹EDAã‚’å®Ÿè¡Œã™ã‚‹æ–¹æ³•ã€‚
- ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚³ãƒ¼ãƒ‰ã‚’ä½œæˆã—ã€æå‡ºç”¨ã®tarballã‚’ä½œæˆã™ã‚‹æ–¹æ³•ã€‚
- Kaggleã®APIã‚’å®Ÿè¡Œã—ã¦ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã‚’ç›£è¦–ã™ã‚‹æ–¹æ³•ã€‚

## æ‚ªã„ç‚¹
ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ã„ãã¤ã‹ã®å•é¡Œç‚¹ã¯æ¬¡ã®ã¨ãŠã‚Šã§ã™ã€‚

- ï¼ˆå¤ã„ãƒªã‚¹ãƒˆã®ï¼‰å›ºå®šã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãŠã‚Šã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆLBã§å¤‰æ›´ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ï¼ˆãã—ã¦ã€ãƒ‘ãƒ–ãƒªãƒƒã‚¯LBã§å¤‰æ›´ã•ã‚Œã¾ã—ãŸã€‚ï¼‰
- å ´æ‰€ã«é–¢ã™ã‚‹è³ªå•ã—ã‹ã—ã¦ã„ã¾ã›ã‚“ï¼ˆã¤ã¾ã‚Šã€ï¼ˆ1ï¼‰ã©ã®ã‚µãƒ–ã‚«ãƒ†ã‚´ãƒªï¼Ÿ ï¼ˆéƒ½å¸‚ã€å›½ã€ãƒ©ãƒ³ãƒ‰ãƒžãƒ¼ã‚¯ï¼‰ã€ï¼ˆ2ï¼‰ã©ã®å¤§é™¸ï¼Ÿã€ï¼ˆ3ï¼‰æœ€åˆã®æ–‡å­—ã¯ï¼Ÿ ç‰©ã«é–¢ã™ã‚‹è³ªå•ã¯ã—ã¦ã„ã¾ã›ã‚“ï¼‰ã€‚

## æ”¹å–„æ–¹æ³•
ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆLBã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒå¤‰æ›´ã•ã‚ŒãŸã¨ã—ã¦ã‚‚ã€ã“ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã®ãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆã¨æˆ¦ç•¥ã‚’ä½¿ç”¨ã—ã¦ã€Wikipediaã‹ã‚‰æ•°åƒã¾ãŸã¯æ•°ç™¾ä¸‡ã®å˜èªžã‚’é¸æŠžã—ã€ãã®ãƒªã‚¹ãƒˆã‚’ã™ã¹ã¦ã®æ½œåœ¨çš„ãªã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã®ãƒªã‚¹ãƒˆã¨ã—ã¦ä½¿ç”¨ã™ã‚‹ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½œæˆã§ãã¾ã™ã€‚
æ¬¡ã«ã€ãã®ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ã«æ–°ã—ã„åˆ—ã‚’ä½œæˆã—ã€ã™ã¹ã¦ã®å˜èªžã‚’è¨˜è¿°ã™ã‚‹è¿½åŠ ã®æ©Ÿèƒ½ã‚’è¿½åŠ ã—ã€ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ãŒã“ã‚Œã‚‰ã®è¿½åŠ æ©Ÿèƒ½ã‚’æŒã£ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’å°‹ã­ã‚‹äº‹å‰ã«æ±ºã‚ã‚‰ã‚ŒãŸè³ªå•ã‚’ä½œæˆã—ã¾ã™ã€‚æœ€å¾Œã«ã€ä½œæˆã—ãŸãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ¬ãƒ¼ãƒ ï¼ˆè¿½åŠ ã®åˆ—æ©Ÿèƒ½ä»˜ãï¼‰ã®ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã¨ã€æ©Ÿèƒ½ã«é–¢ã™ã‚‹å›žç­”è€…ã®å›žç­”ã«åŸºã¥ã„ã¦æŽ¨æ¸¬ã‚’è¡Œã„ã¾ã™ã€‚

# ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚³ãƒ¼ãƒ‰
ã‚¹ã‚¿ãƒ¼ã‚¿ãƒ¼ã‚³ãƒ¼ãƒ‰ã¯ã“ã¡ã‚‰ã§ã™ [https://www.kaggle.com/code/cdeotte/starter-code-for-llama-8b-llm-lb-0-750](https://www.kaggle.com/code/cdeotte/starter-code-for-llama-8b-llm-lb-0-750)ã€‚

---
# ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ã‚³ãƒ¡ãƒ³ãƒˆ
> ## mxmm2123
> 
> ç´ æ™´ã‚‰ã—ã„ä»•äº‹ã§ã™!!!
> 
> 
> 
---
> ## Rishit Jakharia
> 
> ã“ã‚“ã«ã¡ã¯ï¼ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ã€‚
> 
> Llama 3ãƒ¢ãƒ‡ãƒ«ã®å®Ÿè£…ã§fp4é‡å­åŒ–ã‚’ä½¿ç”¨ã—ã¦ã„ã‚‹ã“ã¨ã«æ°—ã¥ãã¾ã—ãŸã€‚
> 
> GGUFé‡å­åŒ–ã‚’è©¦ã—ãŸã‹ã©ã†ã‹ã€è©¦ã—ãŸå ´åˆã¯ç¾åœ¨ã®å®Ÿè£…ã¨æ¯”è¼ƒã—ã¦ã©ã®ã‚ˆã†ãªçµæžœãŒå‡ºãŸã®ã‹æ•™ãˆã¦ãã ã•ã„ã€‚
> 
> 
> 
> > ## Chris Deotteãƒˆãƒ”ãƒƒã‚¯ä½œæˆè€…
> > 
> > ã“ã‚“ã«ã¡ã¯ã€‚GGUFé‡å­åŒ–ã¯è©¦ã—ã¦ã„ã¾ã›ã‚“ã€‚åˆ¥ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆï¼ˆã¤ã¾ã‚Šã€Kaggleã®20å•ã‚²ãƒ¼ãƒ ã‚³ãƒ³ãƒšã§ã¯ã‚ã‚Šã¾ã›ã‚“ï¼‰ã§ã€Hugging Faceã®AutoModelForCausalLMã§AWQé‡å­åŒ–ã‚’è©¦ã—ãŸã“ã¨ãŒã‚ã‚Šã¾ã™ãŒã€fp4ã¨æ¯”ã¹ã¦éžå¸¸ã«é…ã‹ã£ãŸã§ã™ã€‚ãã®ãŸã‚ã€GGUFã‚’è©•ä¾¡ã™ã‚‹éš›ã«ã¯ã€ãã®é€Ÿåº¦ã‚‚è€ƒæ…®ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
> > 
> > 
> > 
> > > ## Rishit Jakharia
> > > 
> > > ã‚ã‹ã‚Šã¾ã—ãŸã€ã‚ã‚ŠãŒã¨ã†ï¼
> > > 
> > > 
> > > 
---
> ## Valentin Baltazar
> 
> ã“ã‚Œã¯ç§ã®ã‚ˆã†ãªåˆå¿ƒè€…ã«ã¨ã£ã¦ç´ æ™´ã‚‰ã—ã„ã‚‚ã®ã§ã™ï¼ã‚ã‚ŠãŒã¨ã†ã€‚
> 
> 
> 
---
> ## torino
> 
> [@cdeotte](https://www.kaggle.com/cdeotte) ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’å…±æœ‰ã—ã¦ãã‚Œã¦ã‚ã‚ŠãŒã¨ã†ã€‚ã‚ªãƒ•ãƒ©ã‚¤ãƒ³ã§Pythonãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ã„ã‚‹ã®ã‚’è¦‹ã¾ã—ãŸãŒã€ç§ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã§ã¯ã€æå‡ºç’°å¢ƒã«æ–°ã—ã„pytorchã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã¾ã›ã‚“ï¼ˆé€šå¸¸ã®ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã§ã¯æ­£å¸¸ã«å‹•ä½œã—ã¾ã—ãŸï¼‰ã€‚ä½•ã‹ææ¡ˆã¯ã‚ã‚Šã¾ã™ã‹ï¼Ÿç§ã®å•é¡Œã¯ã“ã¡ã‚‰ã§è¦‹ã‚‹ã“ã¨ãŒã§ãã¾ã™ [https://www.kaggle.com/competitions/llm-20-questions/discussion/520207](https://www.kaggle.com/competitions/llm-20-questions/discussion/520207)
> 
> 
> 
---

