# 要約 
このディスカッションは、Kaggleコンペティション参加者が、トレーニングデータと隠されたテストデータの間に分布シフトがあるのではないかと疑っていることから始まります。参加者は、Gemmaモデルをトレーニングデータで1エポックだけトレーニングしたところ、ローカル評価では良い結果が出ましたが、リーダーボードではスコアが低くなったと報告しています。

他の参加者は、この現象はモデルがトレーニングデータに過剰適合しているためであり、検証データセットを使用せずにトレーニングデータ全体でモデルを評価したことが原因であると指摘しています。

参加者は、トレーニングデータとテストデータの分布が異なる可能性があることを認識し、その原因として、トークン化されたデータやテキストの最初の部分だけを抽出したことが挙げられています。

このディスカッションは、機械学習モデルのトレーニングと評価における重要な概念である、過剰適合とデータリークについて説明しています。参加者は、モデルを評価するために検証データセットを使用することの重要性を学び、トレーニングデータとテストデータの分布の違いを考慮する必要があることを理解しました。


---
# 隠されたテストデータセットに分布シフトがある

**Xin** *2024年8月3日土曜日 02:30:10 GMT+0900 (日本標準時)* (-11 votes)
トレーニングデータセットからいくつかの特徴量を抽出し、その後、全データセットで1エポックのトレーニングを行ったところ、Gemmaモデル単体でリーダーボードで良い結果が得られると思いましたが、実際には評価値は0.867、リーダーボードは0.933でした。
これは、データの分布がトレーニングデータセットとはある程度異なることを意味しているのではないかと考えられます。その後、テストデータセットから特徴量を抽出したところ、スコアが低くなりました。
---
# 他のユーザーからのコメント
> ## CPMP
> 
> あなたが見ているのは、モデルが新しいデータよりもトレーニングデータでより良いパフォーマンスを発揮しているということです。これは予想されることです。
> 
> 驚かないようにするには、トレーニングデータを2つに分割します。1つはトレーニングに使用し、もう1つはトレーニング後にモデルの評価に使用します。2番目の部分は、しばしば検証データセットまたはテストデータセットと呼ばれます。
> 
> 
> 
---
> ## Valentin Werner
> 
> あなたは「初心者向けのミス」で多くの反発を受けています。たとえ1エポックしかトレーニングしていなくても、モデルを未知のデータで検証する必要があります。モデルはすでに「検証」データを見たことがあるので、それを知っています。これはデータリークの一種です。
> 
> このトレーニングだけでは、モデルがリーダーボード提出でどの程度のパフォーマンスを発揮するかを予測することはできません。多くの場合、ローカル検証とリーダーボードスコアを得るために、データの10〜20％を別に設定しておく方が良いでしょう。
> 
> リーダーボードデータセットのデータ分布を調べることは可能ですが、このアプローチではできません。
> 
> 
> 
> > ## XinTopic Author
> > 
> > はい、理解しました。1エポックでも、モデルはデータを見たことがない状態になる可能性があります。結果から、トレーニングデータセットと隠されたテストデータセットの分布が異なるか、トレーニングデータセット（トークン化されたデータ、おそらくテキストの最初の部分だけを抽出したため）に高い類似性があり、このような明らかな過剰適合を引き起こしているのではないかと直感的に考えています。
> > 
> > 
> > 
---
> ## JM
> 
> あなたのeval_datasetは、トレーニングデータセットのサブセットを使用しています…
> 
> 
> 
> > ## XinTopic Author
> > 
> > はい。しかし、1エポックでは、モデルはデータを見たことが1回だけです。
> > 
> > 
> > 
> > > ## David.Ricardo.H.X
> > > 
> > > 彼の言っていることが理解できていません…
> > > 
> > > あなたのeval_datasetは、トレーニングデータセットのサブセットを使用しています…
> > > 
> > > トレーニングセット、検証セット、テストセットの違いを理解していますか？
> > > 
> > > 
> > > 
---

