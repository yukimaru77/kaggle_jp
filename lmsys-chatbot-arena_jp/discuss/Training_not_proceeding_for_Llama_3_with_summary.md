# è¦ç´„ 
ã“ã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã¯ã€Kaggleã®LMSYS - Chatbot Arena Human Preference Predictionsã‚³ãƒ³ãƒšãƒ†ã‚£ã‚·ãƒ§ãƒ³ã§ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼JamshaidSohailãŒLlama 2ãƒ¢ãƒ‡ãƒ«ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã§å•é¡Œã«é­é‡ã—ã€è§£æ±ºç­–ã‚’æ±‚ã‚ãŸã‚‚ã®ã§ã™ã€‚

JamshaidSohailã¯ã€kishanvavdaraãŒå…±æœ‰ã—ãŸãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã‚’ä½¿ã£ã¦Llama 2ãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã—ãŸãŒã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãŒé€²ã¾ãªã„ã¨ã„ã†å•é¡Œã«ç›´é¢ã—ã¦ã„ã¾ã—ãŸã€‚

Valentin Wernerã¯ã€tqdmã‚’å†…éƒ¨ãƒ«ãƒ¼ãƒ—ï¼ˆã‚¨ãƒãƒƒã‚¯å†…ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼‰ã«å¤‰æ›´ã—ã¦ã€å®Ÿéš›ã«ä½•ã‹å‹•ä½œã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã‚’ææ¡ˆã—ã¾ã—ãŸã€‚ã¾ãŸã€æœ€åˆã®ã‚µãƒ³ãƒ—ãƒ«ã¯æ•°åˆ†ã‹ã‹ã‚‹ã“ã¨ãŒã‚ã‚‹ãŸã‚ã€ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ãƒªã‚»ãƒƒãƒˆã—ã¦å†è©¦è¡Œã™ã‚‹ã“ã¨ã‚’æŽ¨å¥¨ã—ã¾ã—ãŸã€‚

JamshaidSohailã¯ã€Valentin Wernerã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã«å¾“ã„ã€tqdmã‚’STEPS_PER_EPOCHè¡Œã«ã‚‚è¿½åŠ ã—ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãŒå†…éƒ¨ã«å…¥ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚ã•ã‚‰ã«ã€ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã¨ãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿é ˜åŸŸã«è‡ªåˆ†ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®HF_TOKENã‚’è¿½åŠ ã—ãŸã¨ã“ã‚ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚

æœ€çµ‚çš„ã«ã€JamshaidSohailã¯Valentin Wernerã®åŠ©ã‘ã«ã‚ˆã£ã¦å•é¡Œã‚’è§£æ±ºã—ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãŒæ­£å¸¸ã«å‹•ä½œã™ã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸã€‚


---
# Llama 3ã®ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãŒé€²ã¾ãªã„

**JamshaidSohail** *2024å¹´7æœˆ14æ—¥ 20:29:44 (æ—¥æœ¬æ¨™æº–æ™‚)* (0ç¥¨)
ã“ã‚“ã«ã¡ã¯ã€‚ç§ã¯[@kishanvavdara](https://www.kaggle.com/kishanvavdara)ã•ã‚“ãŒå…±æœ‰ã—ãŸ[ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯](https://www.kaggle.com/code/kishanvavdara/lmsys-llama-3-tpu-train/notebook)ã‚’ä½¿ã£ã¦Llama 2ãƒ¢ãƒ‡ãƒ«ã‚’ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ã—ã‚ˆã†ã¨ã—ã¦ã„ã¾ã™ã€‚ã—ã‹ã—ã€å›³ã®ã‚ˆã†ã«ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãŒé€²ã¿ã¾ã›ã‚“ã€‚ä½•ã‹åŠ©ã‘ãŒã‚ã‚Œã°å¹¸ã„ã§ã™ã€‚  
---
# ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ã‚³ãƒ¡ãƒ³ãƒˆ
> ## Valentin Werner
> 
> ã‚¨ãƒãƒƒã‚¯ã”ã¨ã®tqdmãŒã‚ã‚‹å ´åˆã€ãã‚Œã‚’å†…éƒ¨ãƒ«ãƒ¼ãƒ—ï¼ˆã‚¨ãƒãƒƒã‚¯å†…ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼‰ã«å¤‰æ›´ã—ã¦ã€å®Ÿéš›ã«ä½•ã‹å‹•ä½œã—ã¦ã„ã‚‹ã‹ã©ã†ã‹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚
> 
> ```
> for epoch in range(CFG.NUM_EPOCHS):
>     ste = time()
>     for step in tqdm(range(STEPS_PER_EPOCH)):
>         # Zero Out Gradients
>         OPTIMIZER.zero_grad()
> 
> ```
> 
> ã¾ãŸã€æœ€åˆã®ã‚µãƒ³ãƒ—ãƒ«ã¯æ•°åˆ†ã‹ã‹ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ï¼ˆä¸€åº¦ã€æœ€åˆã®ãƒãƒƒãƒã«300ç§’ã‹ã‹ã‚Šã¾ã—ãŸï¼‰ã€‚ãã®å¾Œã¯é€Ÿåº¦ãŒå‘ä¸Šã—ã¾ã™ã€‚å…±æœ‰ã•ã‚Œã¦ã„ã‚‹ãƒŽãƒ¼ãƒˆãƒ–ãƒƒã‚¯ã¯æŠ€è¡“çš„ã«ã¯å•é¡Œãªãå‹•ä½œã™ã‚‹ãŸã‚ã€ä½•ã‚‚å¤‰æ›´ã—ã¦ã„ãªã„å ´åˆã¯ã€ãƒ•ã‚¡ã‚¯ãƒˆãƒªãƒ¼ãƒªã‚»ãƒƒãƒˆã—ã¦å†è©¦è¡Œã™ã‚‹ã“ã¨ã‚’ãŠå‹§ã‚ã—ã¾ã™ã€‚
> 
> 
> 
> > ## JamshaidSohailãƒˆãƒ”ãƒƒã‚¯ä½œæˆè€…
> > 
> > å¿…è¦ãªå¤‰æ›´ã¯ã€ãƒˆãƒ¼ã‚¯ãƒŠã‚¤ã‚¶ãƒ¼ã¨ãƒ¢ãƒ‡ãƒ«ã®èª­ã¿è¾¼ã¿é ˜åŸŸã«è‡ªåˆ†ã®ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã®HF_TOKENã‚’è¿½åŠ ã™ã‚‹ã“ã¨ã ã‘ã§ã™ã€‚ä»¥ä¸‹ã®ã‚ˆã†ã«ã€‚
> > 
> > ```
> > model_id = "meta-llama/Meta-Llama-3-8B-Instruct"
> > tokenizer = AutoTokenizer.from_pretrained(model_id,use_auth_token=HF_TOKEN)
> > 
> > base_model = LlamaForSequenceClassification.from_pretrained(model_id,
> >                                                             use_auth_token=HF_TOKEN,
> >                                                             torch_dtype=torch.bfloat16,
> >                                                             num_labels=3)    
> > 
> > ```
> > 
> > ã•ã¦ã€ã‚ãªãŸã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹ã«å¾“ã£ã¦ã€tqdmã‚’STEPS_PER_EPOCHè¡Œã«ã‚‚è¿½åŠ ã—ã€ãƒˆãƒ¬ãƒ¼ãƒ‹ãƒ³ã‚°ãŒå†…éƒ¨ã«å…¥ã£ã¦ã„ã‚‹ã®ã‚’ç¢ºèªã—ã¾ã—ãŸã€‚
> > 
> > 
> > 
> > > ## JamshaidSohailãƒˆãƒ”ãƒƒã‚¯ä½œæˆè€…
> > > 
> > > ä»Šã¯å‹•ä½œã—ã¦ã„ã¾ã™ã€‚ã‚³ãƒ¡ãƒ³ãƒˆã¨åŠ©ã‘ã‚’ã‚ã‚ŠãŒã¨ã† ðŸ˜€
> > > 
> > > 
> > > 
---

