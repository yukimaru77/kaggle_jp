# è¦ç´„ 
ã“ã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã¯ã€PyTorchã®`nn.CrossEntropyLoss`é–¢æ•°ã®å‹•ä½œã«ã¤ã„ã¦ã€Shreyansh Murathiaæ°ãŒæŠ±ã„ã¦ã„ãŸç–‘å•ã‚’æ‰±ã£ã¦ã„ã¾ã™ã€‚å½¼ã¯ã€äºˆæ¸¬å€¤ãŒ`[1.0, 0.0, 0.0]`ã§ã€ã‚¿ãƒ¼ã‚²ãƒƒãƒˆãŒ`0`ã®å ´åˆã€æå¤±ãŒ0ã¾ãŸã¯éžå¸¸ã«å°ã•ã„å€¤ã«ãªã‚‹ã“ã¨ã‚’æœŸå¾…ã—ã¦ã„ã¾ã—ãŸãŒã€å®Ÿéš›ã«ã¯`0.5514`ã¨ã„ã†å€¤ãŒè¿”ã•ã‚Œã¾ã—ãŸã€‚

sayoulalaæ°ã¯ã€ã“ã®ç–‘å•ã«å¯¾ã™ã‚‹è©³ç´°ãªèª¬æ˜Žã‚’æä¾›ã—ã¾ã—ãŸã€‚`nn.CrossEntropyLoss`ã¯ã€ç”Ÿã®ãƒ­ã‚¸ãƒƒãƒˆï¼ˆæ­£è¦åŒ–ã•ã‚Œã¦ã„ãªã„ã‚¹ã‚³ã‚¢ï¼‰ã¨ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å—ã‘å–ã‚Šã€`LogSoftmax`ã¨`NLLLoss`ã‚’çµ„ã¿åˆã‚ã›ãŸè¨ˆç®—ã«ã‚ˆã£ã¦æå¤±ã‚’ç®—å‡ºã—ã¾ã™ã€‚

sayoulalaæ°ã¯ã€ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã§è¨ˆç®—éŽç¨‹ã‚’èª¬æ˜Žã—ã€`LogSoftmax`å¤‰æ›ã«ã‚ˆã£ã¦ãƒ­ã‚¸ãƒƒãƒˆãŒãƒ­ã‚°ç¢ºçŽ‡ã«å¤‰æ›ã•ã‚Œã€`NLLLoss`ã«ã‚ˆã£ã¦æ­£ã—ã„ã‚¯ãƒ©ã‚¹ã®è² ã®å¯¾æ•°å°¤åº¦ãŒè¨ˆç®—ã•ã‚Œã‚‹ã“ã¨ã‚’ç¤ºã—ã¾ã—ãŸã€‚

Shreyansh Murathiaæ°ã¯ã€sayoulalaæ°ã®èª¬æ˜Žã«æ„Ÿè¬ã—ã€ç–‘å•ãŒè§£æ¶ˆã•ã‚ŒãŸã“ã¨ã‚’è¡¨æ˜Žã—ã¾ã—ãŸã€‚

è¦ç´„ã™ã‚‹ã¨ã€ã“ã®ãƒ‡ã‚£ã‚¹ã‚«ãƒƒã‚·ãƒ§ãƒ³ã¯ã€PyTorchã®`nn.CrossEntropyLoss`é–¢æ•°ã®å‹•ä½œã«ã¤ã„ã¦ã€å…·ä½“çš„ãªä¾‹ã‚’ç”¨ã„ã¦è§£èª¬ã—ãŸã‚‚ã®ã§ã™ã€‚sayoulalaæ°ã®ä¸å¯§ãªèª¬æ˜Žã«ã‚ˆã£ã¦ã€Shreyansh Murathiaæ°ã®ç–‘å•ã¯è§£æ¶ˆã•ã‚Œã¾ã—ãŸã€‚


---
# ãƒ˜ãƒ«ãƒ—ï¼æå¤±é–¢æ•°ãŒæœŸå¾…é€šã‚Šã«å‹•ä½œã—ã¦ã„ã¾ã›ã‚“ï¼
**Shreyansh Murathia** *2024å¹´7æœˆ27æ—¥åœŸæ›œæ—¥ 22:43:41 GMT+0900 (æ—¥æœ¬æ¨™æº–æ™‚)* (0 ç¥¨)

```python
pred = torch.tensor([[1.0, 0.0, 0.0]])
target = torch.tensor([0])
loss_fct = nn.CrossEntropyLoss()

loss = loss_fct(pred, target)
loss

tensor(0.5514)
```

æå¤±ã¯0ã‹éžå¸¸ã«å°ã•ã„å€¤ã«ãªã‚‰ãªã„ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿãªãœ0.5514ã‚’è¿”ã—ã¦ã„ã‚‹ã®ã§ã—ã‚‡ã†ã‹ï¼Ÿ
ã“ã®è³ªå•ãŒéžå¸¸ã«ç°¡å˜ã§ã‚ã‚Œã°ç”³ã—è¨³ã‚ã‚Šã¾ã›ã‚“ã€‚ç§ã¯ã“ã®æå¤±é–¢æ•°ã«ã‚ã¾ã‚Šè©³ã—ãã‚ã‚Šã¾ã›ã‚“ã€‚
---
# ä»–ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‹ã‚‰ã®ã‚³ãƒ¡ãƒ³ãƒˆ
> ## sayoulala
> 
> gpt4ã‹ã‚‰ã®å›žç­”:
> 
> ã”å¿ƒé…ãªãï¼ã‚ãªãŸã®è³ªå•ã¯å…¨ãå¦¥å½“ã§ã€å–œã‚“ã§èª¬æ˜Žã—ã¾ã™ã€‚
> 
> ã‚ãªãŸã®ä¾‹ã§ã¯ã€PyTorchã®`nn.CrossEntropyLoss`ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯`nn.LogSoftmax`ã¨`nn.NLLLoss`ï¼ˆè² ã®å¯¾æ•°å°¤åº¦æå¤±ï¼‰ã‚’çµ„ã¿åˆã‚ã›ãŸã‚‚ã®ã§ã™ã€‚ã‚ãªãŸã®ä¾‹ã‚’åˆ†è§£ã—ã¦ã€ãªãœ0.5514ã®æå¤±å€¤ãŒå¾—ã‚‰ã‚Œã‚‹ã®ã‹èª¬æ˜Žã—ã¾ã™ã€‚
> 
> PyTorchã«ãŠã‘ã‚‹CrossEntropyLoss
> 
> `nn.CrossEntropyLoss`ã¯ä»¥ä¸‹ã‚’æœŸå¾…ã—ã¾ã™ã€‚
> 
> * `pred`ï¼ˆäºˆæ¸¬å€¤ï¼‰ï¼šå„ã‚¯ãƒ©ã‚¹ã®ç”Ÿã®æ­£è¦åŒ–ã•ã‚Œã¦ã„ãªã„ã‚¹ã‚³ã‚¢ï¼ˆé€šå¸¸ã¯ã€Œãƒ­ã‚¸ãƒƒãƒˆã€ã¨å‘¼ã°ã‚Œã‚‹ï¼‰ã‚’å«ã‚€2æ¬¡å…ƒãƒ†ãƒ³ã‚½ãƒ«ã€‚å½¢çŠ¶ï¼š(ãƒãƒƒãƒã‚µã‚¤ã‚ºã€ã‚¯ãƒ©ã‚¹æ•°)ã€‚
> * `target`ï¼šçœŸã®ã‚¯ãƒ©ã‚¹ã‚¤ãƒ³ãƒ‡ãƒƒã‚¯ã‚¹ã‚’å«ã‚€1æ¬¡å…ƒãƒ†ãƒ³ã‚½ãƒ«ã€‚å½¢çŠ¶ï¼š(ãƒãƒƒãƒã‚µã‚¤ã‚º)ã€‚
> 
> `CrossEntropyLoss`ã¯ã€æœ€åˆã«ç”Ÿã®ã‚¹ã‚³ã‚¢ã«`LogSoftmax`é–¢æ•°ã‚’é©ç”¨ã—ã¦ã€ãƒ­ã‚°ç¢ºçŽ‡ã«å¤‰æ›ã—ã¾ã™ã€‚æ¬¡ã«ã€`NLLLoss`ã‚’ä½¿ç”¨ã—ã¦ã€æ­£ã—ã„ã‚¯ãƒ©ã‚¹ã®è² ã®å¯¾æ•°å°¤åº¦ã‚’è¨ˆç®—ã—ã¾ã™ã€‚
> 
> ã‚ãªãŸã®ä¾‹ã§ã¯:
> 
> ```python
> import torch
> 
> import torch.nn as nn
> 
> pred = torch.tensor([[1.0, 0.0, 0.0]])
> 
> target = torch.tensor([0])
> 
> loss_fct = nn.CrossEntropyLoss()
> 
> loss = loss_fct(pred, target)
> 
> print(loss)  # å‡ºåŠ›: tensor(0.5514)
> ```
> 
> ã‚¹ãƒ†ãƒƒãƒ—ãƒã‚¤ã‚¹ãƒ†ãƒƒãƒ—ã®èª¬æ˜Ž
> 
> ç”Ÿã®ãƒ­ã‚¸ãƒƒãƒˆï¼ˆ`pred`ï¼‰ï¼š
> 
> ```python
> [[1.0, 0.0, 0.0]]
> ```
> 
> ãƒ­ã‚¸ãƒƒãƒˆã¸ã®`LogSoftmax`ã®é©ç”¨ï¼š`LogSoftmax`å¤‰æ›ã¯ã€ãƒ­ã‚¸ãƒƒãƒˆã‚’ãƒ­ã‚°ç¢ºçŽ‡ã«å¤‰æ›ã—ã¾ã™ã€‚`pred`ã®å ´åˆã€çµæžœã®ãƒ­ã‚°ç¢ºçŽ‡ã¯ä»¥ä¸‹ã®ã‚ˆã†ã«è¨ˆç®—ã•ã‚Œã¾ã™ã€‚
> 
> ```python
> log_probabilities = torch.log_softmax(pred, dim=1)
> ```
> 
> `pred`ã«å¯¾ã™ã‚‹ã‚½ãƒ•ãƒˆãƒžãƒƒã‚¯ã‚¹å¤‰æ›ã¯æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
> 
> ```python
> softmax(pred) = [exp(1.0)/sum(exp(1.0) + exp(0.0) + exp(0.0)),
> 
>                  exp(0.0)/sum(exp(1.0) + exp(0.0) + exp(0.0)),
> 
>                  exp(0.0)/sum(exp(1.0) + exp(0.0) + exp(0.0))]
> 
>              â‰ˆ [0.5761, 0.2119, 0.2119]
> ```
> 
> ã‚½ãƒ•ãƒˆãƒžãƒƒã‚¯ã‚¹ç¢ºçŽ‡ã«ãƒ­ã‚°ã‚’é©ç”¨ã™ã‚‹ã¨ã€æ¬¡ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
> 
> ```python
> log_probabilities = [log(0.5761), log(0.2119), log(0.2119)]
> 
>                   â‰ˆ [-0.5514, -1.5514, -1.5514]
> ```
> 
> ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¯ãƒ©ã‚¹ã®è² ã®å¯¾æ•°å°¤åº¦ï¼šã‚¿ãƒ¼ã‚²ãƒƒãƒˆã‚¯ãƒ©ã‚¹ã¯0ï¼ˆ`target` = [0]ï¼‰ãªã®ã§ã€æœ€åˆã®è¦ç´ ã®ãƒ­ã‚°ç¢ºçŽ‡ã‚’å–å¾—ã—ã¾ã™ã€‚
> 
> ```python
> loss = -log_probabilities[0]
> 
>      = -(-0.5514)
> 
>      = 0.5514
> ```
> 
> ã¾ã¨ã‚
> 
> 0.5514ã®æå¤±å€¤ã¯é–“é•ã£ã¦ã„ã¾ã›ã‚“ã€‚ã“ã‚Œã¯ã€ã‚ãªãŸã®äºˆæ¸¬ã«å¯¾ã™ã‚‹æ­£ã—ã„ã‚¯ãƒ©ã‚¹ï¼ˆã‚¯ãƒ©ã‚¹0ï¼‰ã®ãƒ­ã‚°ç¢ºçŽ‡ã‹ã‚‰å°Žãå‡ºã•ã‚Œã¾ã™ã€‚äºˆæ¸¬ãŒå®Œç’§ã§ã¯ãªã„ï¼ˆä»–ã®ã‚¯ãƒ©ã‚¹ã«å¯¾ã—ã¦1.0ã®ç”Ÿã®ãƒ­ã‚¸ãƒƒãƒˆã«å¯¾ã—ã¦0.0ï¼‰ã¨ã„ã†äº‹å®Ÿã¯ã€ã‚¼ãƒ­ä»¥å¤–ã®æå¤±ã«ã¤ãªãŒã‚Šã¾ã™ã€‚
> 
> ã‚¯ãƒ©ã‚¹0ã®ãƒ­ã‚¸ãƒƒãƒˆãŒå¤§å¹…ã«é«˜ã‹ã£ãŸå ´åˆï¼ˆä¾‹ï¼š[10.0, 0.0, 0.0]ï¼‰ã€ã‚¯ãƒ©ã‚¹0ã®ã‚½ãƒ•ãƒˆãƒžãƒƒã‚¯ã‚¹ç¢ºçŽ‡ã¯1ã«è¿‘ããªã‚Šã€æå¤±ã¯0ã«è¿‘ããªã‚Šã¾ã™ã€‚ã“ã“ã§ã¯ã€1ã®ãƒ­ã‚¸ãƒƒãƒˆã¯ã€ã»ã¼ã‚¼ãƒ­ã®ã‚½ãƒ•ãƒˆãƒžãƒƒã‚¯ã‚¹ç¢ºçŽ‡ã‚’ä¸Žãˆã‚‹ã«ã¯ååˆ†ã«é«˜ããªãã€ãã®ãŸã‚ã‚¼ãƒ­ä»¥å¤–ã®æå¤±ãŒç”Ÿã˜ã¾ã™ã€‚
> 
> ä»–ã®è³ªå•ãŒã‚ã‚‹å ´åˆã‚„ã€ã•ã‚‰ã«èª¬æ˜ŽãŒå¿…è¦ãªå ´åˆã¯ã€ãŠæ°—è»½ã«ãŠå•ã„åˆã‚ã›ãã ã•ã„ï¼
> 
> 
> 
> > ## sayoulala
> > 
> > å…¥åŠ›å€¤ã¯ç¢ºçŽ‡ã§ã¯ãªãã€ã‚½ãƒ•ãƒˆãƒžãƒƒã‚¯ã‚¹ã‚’é©ç”¨ã™ã‚‹å‰ã®å€¤ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚
> > 
> > 
> > 
> > ## Shreyansh Murathiaãƒˆãƒ”ãƒƒã‚¯ä½œæˆè€…
> > 
> > ã©ã†ã‚‚ã‚ã‚ŠãŒã¨ã† ðŸ˜Š
> > 
> > 
> > 
---

